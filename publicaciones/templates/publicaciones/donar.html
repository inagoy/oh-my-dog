{% extends 'base.html' %}{% load static %}
{% block content %}
<link href="{% static 'css/index.css' %}" rel="stylesheet" />
<link href="{% static 'css/global.css' %}" rel="stylesheet" />



<div style="padding-left: 20rem; padding-right: 20rem;">
<div align="center" style="border: solid 0.2rem #2699b1;">
<br/>
<div align="left" style="padding-left: 10px; width: 85%" >
  <br/>
  <h1 >Donar a campaña {{campania.nombre}}</h1>
  <br/>

  <form method="POST" id="donar">
  {% csrf_token %}

    {% for field in form_donacion %}
      <label for="{{ field.id_for_label }}" class="form-label" style="font-size: 1.2rem; font-weight: 600">{{ field.label }}</label>
      {{ field }}
      <br/>
    {% endfor %}

    {% for field in form_tarjeta %}
      <label for="{{ field.id_for_label }}" class="form-label" style="font-size: 1.2rem; font-weight: 600">{{ field.label }}</label>
      {{ field }}
      <br/>
    {% endfor %}

    <br/><br/>

<!--    <a type="submit" class="btn btn-primary botones" href="{% url 'donar' campania_id=campania.id %}">Donar</a>-->

    <button type="submit" class="btn btn-primary botones" id="hacer_donacion">Hacer donación</button>

  </form>
</div>
<br/>
</div>
</div>

<div>

        <dialog id="conexion_servidor">
            <div align="center">
                <p style="text-transform:uppercase; font-size: 1.5rem; font-weight: bold">Conectando con el servidor</p>
                <img class="animated-gif" id="img" src="{% static 'conexion_servidor2.gif' %}" style="width: 350px; height: 350px;">
            </div>
        </dialog>

        <script>
          function abrir() {
            const element = document.getElementById("conexion_servidor");
            element.showModal();
            setTimeout(cerrar, 4000);
          }
        </script>

        <script>
          function cerrar() {
            const element = document.getElementById("conexion_servidor");
            element.close();
          }
        </script>

    <script>
    const element = document.getElementById("hacer_donacion")
    element.addEventListener("click", function(){ chequear(event); });
    </script>

    <script>
        function chequear(ev){
            event.preventDefault();
            const form = document.getElementById("donar")
            if (form.checkValidity() === false){
                form.reportValidity();
                return;
            }
            else{
                abrir();
                form.submit();
            }
        }
    </script>

</div>
{% endblock %}


