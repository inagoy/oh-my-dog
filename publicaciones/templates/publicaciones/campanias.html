{% extends 'base.html' %}{% load static %} {% block content %}
<link href="{% static 'css/index.css' %}" rel="stylesheet" />
<link href="{% static 'css/global.css' %}" rel="stylesheet" />

{% if user.is_staff %}
<a
  class="btn btn-primary centerObjects w-50 botones"
  href="{% url 'crear_adopcion' %}"
  role="button"
>
  Cargar campaña de donación
</a>
<br />
{% else %}
<div class="banner centerObjects" style="height: 4rem">
  <div class="vertical_align" style="font-weight: bold">
    Estas son las campañas disponibles para donar actualmente
  </div>
</div>
{% endif %}

{% if campanias %}
{% for campania in campanias %}

<div class="card text-center card-s centerObjects">
  <div class="card-header">
    {{ campania.nombre }}
  </div>
  <div class="card-body">
    <p class="card-text">
      Foto: - 
    </p>
    <p class="card-text">
     Descripción: {% if campania.descripcion %} {{ campania.descripcion }} {% else %} - {% endif %}
    </p>
    {% if user.is_authenticated %}
<!--    and adopcion.estado_publicacion == "A"-->
    <a
      onclick=""
      class="btn btn-primary botones"
      >Donar</a
    >
    {% endif %}

  </div>
  <dialog id="dial_contestar_adopcion{{adopcion.id}}">
    <p></p>
    <form
      method="POST"
      action="{% url 'contestar_adopcion' usuario_id=adopcion.usuario.id adopcion_id=adopcion.id %}"
    >
      {% csrf_token %} {{ form.as_p }}
      <div style="float=left">
        {% if not user.is_authenticated %}
        <label for="nombre">Nombre:</label>
        <input type="text" id="nombre" name="Nombre" required="true"/><br /><br/>
        <label for="email">Email:</label>
        <input type="email" id="email" name="Email" required="true"/><br /><br/>
        {% endif %}
        <label for="mensaje">Mensaje:</label>
        <textarea id="mensaje" name="Mensaje" cols="40" rows="5" placeholder="Mensaje de su parte que recibirá el dueño de la publicación"></textarea><br /><br />
        {% if user.is_authenticated %}
        <p>Se enviarán además su nombre y su email</p>
        {% endif %}
        <button type="button submit" class="btn btn-primary botones" style="float: right; margin-right: 0.2cm">Enviar mail de solicitud</button>
      </div>
    </form>
  </dialog>
  <script>
    function contestarAdopcion(adopcion_id) {
      const element = document.getElementById("dial_contestar_adopcion"+adopcion_id);
      element.showModal();
    }
  </script>

  <dialog id="dialogoAdopcion{{adopcion.id}}">
    <p>¿La adopción ya ha sido llevada a cabo?</p>
    <div>
      <input
        type="button"
        class="special_link"
        value="No"
        onclick="cerrarAdopcion({{adopcion.id}})"
      />
      <a
        type="button"
        class="special_link"
        href="{% url 'marcar_adopcion_resuelta' nroAdopcion=adopcion.id %}"
      >
        Si
      </a>
    </div>
  </dialog>

  <script>
    function confirmarAdopcion(idAdopcion) {
      const element = document.getElementById("dialogoAdopcion" + idAdopcion);
      element.showModal();
    }
  </script>
  <script>
    function cerrarAdopcion(idAdopcion) {
      const element = document.getElementById("dialogoAdopcion" + idAdopcion);
      element.close();
    }
  </script>
</div>
<br />
{% endfor %} 
{% else %}
<h2 class="centerObjects"> Cargar campaña Refugio!!</h2>
{% endif %}
{% endblock %}