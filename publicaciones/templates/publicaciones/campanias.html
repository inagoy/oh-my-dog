{% extends 'base.html' %}{% load static %} {% block content %}
<link href="{% static 'css/index.css' %}" rel="stylesheet" />
<link href="{% static 'css/global.css' %}" rel="stylesheet" />

{% if user.is_staff %}
<a class="btn btn-primary centerObjects w-50 botones" onclick="crear_campania()" role="button">Cargar campaña de donación</a>
<br />
{% else %}
<div class="banner centerObjects" style="height: 4rem">
  <div class="vertical_align" style="font-weight: bold">
    Estas son las campañas disponibles para donar actualmente
  </div>
</div>
{% endif %}


{% if campanias %}
{% for campania in campanias %}

<div class="card text-center card-s centerObjects" style="width:45rem;">  <!--  border: 2px solid #2699b1;-->

  <div class="card-header" style="font-size: 1.4rem; font-weight: bold;">
    {{ campania.nombre }}
  </div>

  <div class="card-body">
    <p class="card-text" style="font-size: 1.2rem; padding: 1.5rem">
     {% if campania.descripcion %} {{ campania.descripcion }} {% else %} "" {% endif %}
    </p>
    <label for="monto_recaudado" style="font-weight: bold;">Monto recaudado hasta el momento:</label>
    <p id="monto_recaudado" style="font-size: 1.4rem; font-weight: bold; color: green">
      {{ campania.monto_recaudado }}
    </p>
    {% if campania.dias_restantes == -1 %}
    <p style="font-weight: bold;">Esta campaña es permanente</p>
    {% elif campania.dias_restantes == 0 %}
    <p style="font-weight: bold;">La campaña cierra hoy</p>
    {% else %}
    <p style="font-weight: bold;">En {{ campania.dias_restantes }} días cierra la campaña</p>
    {% endif %}
    <a
      href="{% url 'donar' campania_id=campania.id %}"
      class="btn btn-primary botones"
      >Donar</a
    >
  </div>

</div>
<br/><br/>

{% endfor %}

{% else %}
<h2 class="centerObjects"> Cargar campaña Refugio!!</h2>
{% endif %}




</div>
  <dialog id="dial_crear_campania">
    <p></p>
    <form
      method="POST"
      action="{% url 'crear_campania' %}"
    >
      {% csrf_token %} {{ form.as_p }}
      <div align="left">
        <p align="center" style="font-size: 1.4rem; font-weight: bold"> Nueva campaña de donación </p><br/>
        <label for="nombre">Nombre:</label>
        <input type="text" id="nombre" name="nombre" required/><br/><br/>
        <label for="descripcion">Descripción:</label>
        <input type="text" id="descripcion" name="descripcion" required/><br/><br/>
        <label for="fecha_limite">Fecha límite para donar:</label>
        <input type="date" id="fecha_limite" name="fecha_limite"/><br/><br/><br/>
        <button type="button submit" class="btn btn-primary botones" style="float: right; margin-right: 0.2cm">Crear campaña</button>
      </div>
      <script>
        var today = new Date();
        var dd = today.getDate();
        var mm = today.getMonth() + 1; //January is 0!
        var yyyy = today.getFullYear();

        if (dd < 10) {
           dd = '0' + dd;
        }

        if (mm < 10) {
           mm = '0' + mm;
        }

        today = yyyy + '-' + mm + '-' + dd;
        document.getElementById("fecha_limite").setAttribute("min", today);
      </script>
    </form>
  </dialog>
  <script>
    function crear_campania() {
      const element = document.getElementById("dial_crear_campania");
      element.showModal();
    }
  </script>
</div>

{% endblock %}